<section class="w-full mx-auto">
  <!-- User Greeting and Division Info -->
  <div class="bg-white rounded-3xl shadow p-5 mb-4">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center">
      <div class="flex flex-row gap-2 items-center">
        <ng-lottie 
          class="mb-1"
          [options]="lottieOptions" 
          style="width: 50px; height: 50px;"
        ></ng-lottie>
        <h2 class="text-xl font-medium text-neutral-900 mb-1">
          {{ inspirationalQuote }}
        </h2>
      </div>     
      <div class="w-full sm:w-48">
        <label for="time-range" class="block text-sm font-medium text-gray-700 mb-1">Time Range</label>
        <select
          id="time-range"
          [(ngModel)]="selectedTimeRange"
          (change)="onTimeRangeChange()"
          class="mt-1 block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
        >
          <option value="day">Day</option>
          <option value="month">Month</option>
          <option value="year">Year</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Metrics Overview -->
  <div class="grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-3 gap-4 mb-6">
    <article *ngFor="let metric of metrics" class="bg-white p-4 rounded-3xl shadow">
      <div class="flex flex-col items-center">
        <h3 class="text-xl font-bold text-neutral-900">
          <!-- Special formatting for Average Service Time -->
          <ng-container *ngIf="metric.label === 'Average Service Time'">
            <div class="flex items-baseline gap-1">
              <span class="text-2xl">{{metric.value.split(' ')[0]}}</span>
              <span class="text-sm text-gray-500">min</span>
              <span class="text-2xl">{{metric.value.split(' ')[2]}}</span>
              <span class="text-sm text-gray-500">sec</span>
            </div>
          </ng-container>
          <!-- Regular display for other metrics -->
          <ng-container *ngIf="metric.label !== 'Average Service Time'">
            {{metric.value}}
          </ng-container>
        </h3>
        <p class="mt-2 text-sm text-slate-500">{{ metric.label }}</p>
      </div>
    </article>
  </div>

  <!-- Charts Section -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Service Time Distribution -->
    <section class="bg-white p-6 rounded-3xl shadow">
      <h3 class="text-lg font-medium text-neutral-900 mb-4">Service Time Distribution</h3>
      <div *ngIf="serviceTimeDistribution.length; else noData" class="space-y-4">
        <div *ngFor="let item of serviceTimeDistribution" class="flex items-center space-x-4">
          <span class="w-20 text-sm font-medium text-slate-500">{{ item.range }}</span>
          <div class="flex-grow bg-gray-200 rounded-full h-2.5">
            <div class="bg-blue-600 h-2.5 rounded-full" [style.width]="item.percentage + '%'"></div>
          </div>
          <span class="w-16 text-sm text-slate-500 text-right">{{ item.percentage.toFixed(1) }}%</span>
        </div>
      </div>
      <ng-template #noData>
        <p class="text-sm text-gray-500">No data available.</p>
      </ng-template>
    </section>

    <!-- Daily Customer Served -->
    <section class="bg-white p-6 rounded-3xl shadow">
      <h3 class="text-lg font-medium text-neutral-900 mb-4">Daily Customer Served</h3>
      <p class="text-sm text-gray-500 mb-2">Total Customers Served: {{ metrics[0]?.value }}</p>
      <div class="relative" style="height: 200px;">
        <svg [attr.viewBox]="'0 0 ' + graphWidth + ' ' + graphHeight" style="width: 100%; height: 100%;">
          <polyline [attr.points]="getPointsForLineGraph()" fill="none" stroke="#3b82f6" stroke-width="2" />
        </svg>
      </div>
      <div class="flex justify-between text-xs font-medium text-slate-500 mt-2 overflow-x-auto">
        <span
          *ngFor="let data of dailyCustomerServed; let i = index"
          [style.flex]="'0 0 ' + (100 / dailyCustomerServed.length) + '%'"
          class="text-center"
        >
          {{ i % 3 === 0 || i === dailyCustomerServed.length - 1 ? data.date : '' }}
        </span>
      </div>
    </section>
  </div>
</section>