<div class="min-h-screen bg-white p-6">
  <!-- Counter Selection Screen -->
  <div *ngIf="!selectedCounter" class="max-w-full mx-auto">
    <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
      <header class="bg-[#283c1c] text-white p-8">
        <h1 class="text-4xl font-bold text-center">Registrar Terminals</h1>
        <p class="text-center mt-2 text-[#a3c089]">Please select a counter to proceed</p>
      </header>

      <main class="p-8">
        <h2 class="text-3xl font-semibold mb-8 text-center text-[#283c1c]">Available Counters</h2>
        <div class=" grid grid-cols-3 px-3 py-3 gap-3"> 
          <button 
          (click)="selectCounter(i+1)"
          [disabled]="terminal.status!='available'"
          *ngFor="let terminal of terminals; let i = index" 
          class="group  {{terminal.status == 'maintenance' ? 'bg-yellow-50 border-yellow-500' :'bg-white hover:bg-green-900 hover:text-white hover:border-green-500 '}} h-48 p-4 rounded-lg flex flex-col gap-2 shadow-md border-2 border-solid border-black/10 ">
            <!-- Header -->
            <div class="flex gap-4 items-center">
              <!-- Lottie Container -->
              <div class="w-16 h-12 p-2 rounded-lg bg-green-200 group-hover:bg-yellow-200">
                <app-lottie-animation animation="computer"></app-lottie-animation>
              </div>
              <div class="w-5 h-5 rounded-full {{statusMap[terminal.status]}} bottom-4 right-4"></div>
              <div class="font-medium  tracking-wide text-xl flex items-center gap-2">
                TERMINAL <span class="font-medium text-4xl">{{i+1}}</span>
              </div>
            </div>
            <!-- Body  -->
            <div class="flex-1 py-2 gap-1 w-full flex flex-col items-start ">
              <div>
                <span class="font-medium">{{terminal.status == 'online' ? 'Attendant: ' : 'Last Attendant: '}} </span>
                <span class="opacity-75">{{terminal.attendant ?? 'Not used yet.'}}</span>
              </div>
              <div>
                <span class="font-medium ">{{terminal.status == 'online' ? 'Current Session: ' : 'Last Session: '}} </span>
                <span class="opacity-75">{{terminal.last_active ? (terminal.last_active | date:'MM-dd-yyyy h:mm a' ) : 'No sessions yet.'}}</span>
              </div>
              <div class="flex w-full  mt-2">
                <div class="w-full flex justify-end">

                  <button  class="rounded-lg px-10 py-1 text-white {{statusMap[terminal.status]}}">
                    {{terminal.status == 'online' ? 'Online': terminal.status != 'maintenance'? 'Available':'Maintenance'}}
                  </button>
                </div>
              </div>
            </div>
          </button>

        </div>
      </main>
    </div>
  </div>

  <!-- Terminal Management Screen -->
  <div *ngIf="selectedCounter" class="w-full mx-auto">
    <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
      <header class="bg-[#283c1c] text-white p-6 flex justify-between items-center">
        <h1 class="text-2xl font-bold">Registrar Terminal - Counter {{ selectedCounter }}</h1>
        <button mat-icon-button (click)="resetCounter()" class="bg-[#3a5728] p-2 rounded-full hover:bg-[#4a6d32] transition-colors focus:outline-none focus:ring-2 focus:ring-[#a3c089] focus:ring-opacity-50" aria-label="Reset Counter">
          <mat-icon>swap_horiz</mat-icon>
        </button>
      </header>

      <main class="p-6">
        <!-- Counter Information Section -->
        <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div class="text-center bg-[#f0f4ed] p-6 rounded-xl shadow-md">
            <h3 class="text-lg font-semibold mb-2 text-[#283c1c]">Current Number</h3>
            <p class="text-5xl font-bold text-[#283c1c]">{{ currentNumber }}</p>
          </div>
          <div class="text-center bg-[#f0f4ed] p-6 rounded-xl shadow-md">
            <h3 class="text-lg font-semibold mb-2 text-[#283c1c]">Last Called</h3>
            <p class="text-5xl font-bold text-[#283c1c]">{{ lastCalledNumber }}</p>
          </div>
          <div class="text-center bg-[#f0f4ed] p-6 rounded-xl shadow-md">
            <h3 class="text-lg font-semibold mb-2 text-[#283c1c]">Timer</h3>
            <p class="text-5xl font-bold text-[#283c1c]">{{ timer }}</p>
          </div>
        </section>

        <!-- Main Content Section -->
        <div class="flex flex-col lg:flex-row gap-6">
          <!-- Sidebar with Action Buttons -->
          <section class="w-full lg:w-1/3">
            <div class="bg-[#f0f4ed] rounded-xl shadow-md p-6">
              <h2 class="text-xl font-semibold mb-4 text-[#283c1c]">Actions</h2>
              <nav class="space-y-3">
                <button *ngIf="isNextClientActive"
                        (click)="nextClient()" 
                        class="w-full py-3 rounded-md flex items-center justify-start px-4 font-medium bg-[#283c1c] text-white hover:bg-[#3a5728] active:bg-[#4a6d32] transition-all duration-200 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#a3c089] focus:ring-opacity-50 transform hover:-translate-y-0.5 active:translate-y-0"
                        aria-label="Next Client">
                  <mat-icon class="mr-3">navigate_next</mat-icon>
                  <span>Next Client</span>
                </button>
                <button *ngIf="isClientDoneActive"
                        (click)="clientDone()"
                        class="w-full py-3 rounded-md flex items-center justify-start px-4 font-medium bg-[#4a6d32] text-white hover:bg-[#5c8540] active:bg-[#6e9d4e] transition-all duration-200 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#a3c089] focus:ring-opacity-50 transform hover:-translate-y-0.5 active:translate-y-0"
                        aria-label="Client Done">
                  <mat-icon class="mr-3">done</mat-icon>
                  <span>Client Done</span>
                </button>
                <button *ngIf="isCallNumberActive"
                        (click)="callNumber()"
                        class="w-full py-3 rounded-md flex items-center justify-start px-4 font-medium bg-[#5c8540] text-white hover:bg-[#6e9d4e] active:bg-[#80b55c] transition-all duration-200 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#a3c089] focus:ring-opacity-50 transform hover:-translate-y-0.5 active:translate-y-0"
                        aria-label="Call Number">
                  <mat-icon class="mr-3">phone</mat-icon>
                  <span>Call Number</span>
                </button>
                <button *ngIf="isManualSelectActive"
                        (click)="manualSelect()"
                        class="w-full py-3 rounded-md flex items-center justify-start px-4 font-medium bg-[#a3c089] text-[#283c1c] hover:bg-[#b5d09b] active:bg-[#c7e0ad] transition-all duration-200 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#80b55c] focus:ring-opacity-50 transform hover:-translate-y-0.5 active:translate-y-0"
                        aria-label="Manual Select">
                  <mat-icon class="mr-3">edit</mat-icon>
                  <span>Manual Select</span>
                </button>
                <button *ngIf="isReturnTopActive"
                        (click)="returnTop()"
                        class="w-full py-3 rounded-md flex items-center justify-start px-4 font-medium bg-[#3a5728] text-white hover:bg-[#4a6d32] active:bg-[#5c8540] transition-all duration-200 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#a3c089] focus:ring-opacity-50 transform hover:-translate-y-0.5 active:translate-y-0"
                        aria-label="Return Top">
                  <mat-icon class="mr-3">arrow_upward</mat-icon>
                  <span>Return Top</span>
                </button>
                <button *ngIf="isReturnBottomActive"
                        (click)="returnBottom()"
                        class="w-full py-3 rounded-md flex items-center justify-start px-4 font-medium bg-[#3a5728] text-white hover:bg-[#4a6d32] active:bg-[#5c8540] transition-all duration-200 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#a3c089] focus:ring-opacity-50 transform hover:-translate-y-0.5 active:translate-y-0"
                        aria-label="Return Bottom">
                  <mat-icon class="mr-3">arrow_downward</mat-icon>
                  <span>Return Bottom</span>
                </button>
                <button (click)="noShow()"
                        class="w-full py-3 rounded-md flex items-center justify-start px-4 font-medium bg-[#8b2e2e] text-white hover:bg-[#a33636] active:bg-[#bb3e3e] transition-all duration-200 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-[#d46a6a] focus:ring-opacity-50 transform hover:-translate-y-0.5 active:translate-y-0"
                        aria-label="No Show">
                  <mat-icon class="mr-3">highlight_off</mat-icon>
                  <span>No Show</span>
                </button>
              </nav>
            </div>
          </section>

          <!-- Queue and Client Details Tabs -->
          <section class="w-full lg:w-2/3">
            <mat-tab-group animationDuration="0ms" class="bg-white rounded-xl shadow-md">
              <mat-tab label="Queue">
                <div class="p-6">
                  <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-semibold text-[#283c1c]">Queue</h2>
                    <p class="text-[#4a6d32] font-medium">{{ currentDate }}</p>
                  </div>
                  <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                      <thead>
                        <tr class="bg-[#f0f4ed] text-[#283c1c]">
                          <th class="p-3 text-left font-semibold rounded-tl-lg">Number</th>
                          <th class="p-3 text-left font-semibold">Date & Time</th>
                          <th class="p-3 text-left font-semibold rounded-tr-lg">Type</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let ticket of tickets; let last = last" [ngClass]="{'border-b border-[#dfe9d8]': !last}">
                          <td class="p-3 text-[#283c1c]">{{ ticket.number }}</td>
                          <td class="p-3 text-[#283c1c]">{{ ticket.datetime }}</td>
                          <td class="p-3" [ngClass]="{ 'text-[#8b2e2e] font-semibold': ticket.type === 'Priority', 'text-[#4a6d32] font-semibold': ticket.type === 'Regular' }">
                            {{ ticket.type }}
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </mat-tab>
              <mat-tab label="Client Details" [disabled]="!currentClientDetails">
                <div class="p-6">
                  <h2 class="text-2xl font-semibold mb-4 text-[#283c1c]">Client Details</h2>
                  <div *ngIf="currentClientDetails; else noClient" class="bg-[#f0f4ed] p-6 rounded-xl shadow-inner">
                    <p class="mb-2"><strong class="text-[#283c1c]">Name:</strong> {{ currentClientDetails.name }}</p>
                    <p class="mb-4"><strong class="text-[#283c1c]">Date:</strong> {{ currentClientDetails.date }}</p>
                    <h3 class="text-xl font-semibold mt-4 mb-2 text-[#283c1c]">Services:</h3>
                    <ul class="list-disc pl-5 space-y-2">
                      <li *ngFor="let service of currentClientDetails.services" class="text-[#4a6d32]">
                        <strong>{{ service.name }}</strong>: {{ service.description }}
                      </li>
                    </ul>
                  </div>
                  <ng-template #noClient>
                    <p class="text-[#4a6d32] text-center py-8">No client selected. Press "Next Client" to view details.</p>
                  </ng-template>
                </div>
              </mat-tab>
            </mat-tab-group>
          </section>
        </div>
      </main>
    </div>
  </div>
</div>